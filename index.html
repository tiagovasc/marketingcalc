<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Ad Platform Cost-Effectiveness Calculator</title>
<style>
  body { font-family: Arial, sans-serif; }
  table { width: 100%; border-collapse: collapse; }
  td, th { border: 1px solid #ddd; padding: 8px; text-align: left; }
  input[type=number], input[type=text], span { width: 100%; }
  button { padding: 10px 20px; margin-top: 10px; }
  .results { margin-top: 20px; }
</style>
</head>
<body>

<h2>Ad Platform Cost-Effectiveness Calculator</h2>

<table>
  <tr><th></th><th>Blaze</th><th>Addressable</th></tr>
  <tr><td>Subscription ($)</td><td><input type="number" id="blazeSubscription" value="60"></td><td><input type="number" id="addressableSubscription" value="1500"></td></tr>
  <tr><td>Ad spend ($)</td><td><input type="number" id="blazeAdSpend" value="3000"></td><td><input type="number" id="addressableAdSpend" value="3000"></td></tr>
  <tr><td>Ad spend fee (%)</td><td><input type="number" id="blazeAdSpendFee" value="5"></td><td><input type="number" id="addressableAdSpendFee" value="15"></td></tr>
  <tr><td>Audience optimization (%)</td><td><input type="text" value="0" readonly></td><td><input type="number" id="addressableOptimization" value="100"></td></tr>
  <tr><td>Baseline CPC ($)</td><td colspan="2"><input type="number" id="baselineCPC" value="0.10" step="0.001"></td></tr>
  <tr><td>Clicks</td><td id="blazeClicks">30,000</td><td><input type="number" id="addressableClicks" value="60000"></td></tr>
  <tr><td>True CPC ($)</td><td id="blazeTrueCPC">0.107</td><td id="addressableTrueCPC">0.083</td></tr>
</table>
<button onclick="calculate()">Calculate</button>

<div class="results">
  <h3>Results</h3>
  <p>Blaze True CPC: <span id="blazeTrueCPCOutput"></span></p>
  <p>Addressable True CPC: <span id="addressableTrueCPCOutput"></span></p>
  <h3>Optimization Requirements for Different Budgets</h3>
  <p>$3,000 Budget Required Optimization: <span id="optimization3000"></span></p>
  <p>$10,000 Budget Required Optimization: <span id="optimization10000"></span></p>
  <p>$100,000 Budget Required Optimization: <span id="optimization100000"></span></p>
</div>

<script>
function calculateTrueCPC(subscription, adSpend, feePercent, baselineCPC, optimization) {
  const adSpendFee = adSpend * feePercent / 100;
  const totalCost = adSpend + adSpendFee + subscription;
  const clicks = adSpend / (baselineCPC / (1 + optimization / 100));
  return totalCost / (clicks || 1); // Avoid division by zero
}

function findRequiredOptimization(subscription, adSpend, feePercent, baselineCPC, targetTrueCPC) {
  let low = 0, high = 100, mid, currentCPC;
  while (high - low > 0.001) { // Increase precision with smaller step
    mid = (low + high) / 2;
    currentCPC = calculateTrueCPC(subscription, adSpend, feePercent, baselineCPC, mid);
    if (currentCPC > targetTrueCPC) {
      low = mid;
    } else {
      high = mid;
    }
  }
  return mid;
}

function calculate() {
  const bSub = parseFloat(document.getElementById('blazeSubscription').value);
  const bAdSpend = parseFloat(document.getElementById('blazeAdSpend').value);
  const bFeePercent = parseFloat(document.getElementById('blazeAdSpendFee').value);
  const bBaselineCPC = parseFloat(document.getElementById('baselineCPC').value);
  const aSub = parseFloat(document.getElementById('addressableSubscription').value);
  const aAdSpend = parseFloat(document.getElementById('addressableAdSpend').value);
  const aFeePercent = parseFloat(document.getElementById('addressableAdSpendFee').value);
  const aOptimization = parseFloat(document.getElementById('addressableOptimization').value);
  
  // Calculate True CPC for Blaze
  const blazeTrueCPC = calculateTrueCPC(bSub, bAdSpend, bFeePercent, bBaselineCPC, 0);
  document.getElementById('blazeTrueCPCOutput').textContent = blazeTrueCPC.toFixed(3);
  
  // Calculate True CPC for Addressable with the provided optimization
  const addressableTrueCPC = calculateTrueCPC(aSub, aAdSpend, aFeePercent, bBaselineCPC, aOptimization);
  document.getElementById('addressableTrueCPCOutput').textContent = addressableTrueCPC.toFixed(3);
  
  // Calculate and display the required optimization for Addressable to match Blaze's True CPC for different budgets
  document.getElementById('optimization3000').textContent = findRequiredOptimization(aSub, 3000, aFeePercent, bBaselineCPC, blazeTrueCPC).toFixed(2) + '%';
  document.getElementById('optimization10000').textContent = findRequiredOptimization(aSub, 10000, aFeePercent, bBaselineCPC, blazeTrueCPC).toFixed(2) + '%';
  document.getElementById('optimization100000').textContent = findRequiredOptimization(aSub, 100000, aFeePercent, bBaselineCPC, blazeTrueCPC).toFixed(2) + '%';
}
</script>

</body>
</html>
